{"version":3,"sources":["DrawRect.js","App.js","reportWebVitals.js","index.js"],"names":["DrawRect","p5","this","recordRectCoordinate","x1","y1","x2","y2","w","h","mouseX","mouseY","noFill","stroke","rect","App","img","cnv","React","x","y","rectCoordinates","setRectCoordinates","className","setup","canvasParentRef","DrawRectClass","createCanvas","parent","input","photoView","document","querySelector","photoWrap","label","createElement","classList","add","textContent","insertBefore","nextSibling","insertPhotoView","createFileInput","file","type","createImg","data","hide","handleFile","elt","mousePressed","event","console","log","update","mouseClicked","display","coordinate","prev","map","v","i","draw","width","height","image","mouseIsPressed","style","color","onClick","alert","JSON","stringify","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.bbe663b2.chunk.js","sourcesContent":["export class DrawRect {\n  constructor(p5) {\n    this.p5 = p5;\n    this.recordRectCoordinate = { x1: 0, y1: 0, x2: 0, y2: 0, w: 0, h: 0 };\n  }\n  update({ x1, y1, x2, y2 }) {\n    this.recordRectCoordinate = {\n      ...this.recordRectCoordinate,\n      x1: x1 || this.recordRectCoordinate.x1,\n      y1: y1 || this.recordRectCoordinate.y1,\n      x2: x2 || this.recordRectCoordinate.x2,\n      y2: y2 || this.recordRectCoordinate.y2,\n    };\n  }\n  display() {\n    this.recordRectCoordinate = {\n      ...this.recordRectCoordinate,\n      x2: this.p5.mouseX,\n      y2: this.p5.mouseY,\n      w: this.p5.mouseX - this.recordRectCoordinate.x1,\n      h: this.p5.mouseY - this.recordRectCoordinate.y1,\n    };\n    this.p5.noFill();\n    this.p5.stroke(255, 0, 0);\n    this.p5.rect(\n      this.recordRectCoordinate.x1,\n      this.recordRectCoordinate.y1,\n      this.recordRectCoordinate.w,\n      this.recordRectCoordinate.h\n    );\n  }\n  get coordinate() {\n    return {\n      x1: this.recordRectCoordinate.x1,\n      y1: this.recordRectCoordinate.y1,\n      x2: this.recordRectCoordinate.x2,\n      y2: this.recordRectCoordinate.y2,\n    };\n  }\n}\n","import * as React from \"react\";\nimport \"./App.css\";\nimport Sketch from \"react-p5\";\nimport { DrawRect } from \"./DrawRect\";\nfunction insertPhotoView(input) {\n  let photoView = document.querySelector(\".photo-view\");\n  let photoWrap = document.querySelector(\".photo-wrap\");\n  let label = document.createElement(\"label\");\n  label.classList.add(\"input-upload-label\");\n  label.textContent = \"上傳圖片\";\n  input.classList.add(\"input-upload\");\n  // input.value= '上傳圖片'\n\n  label.insertBefore(input, photoView.nextSibling);\n  photoWrap.insertBefore(label, photoView.nextSibling);\n}\n\nfunction App() {\n  let canvasWidth = 640;\n  let canvasHeight = 320;\n  let img, input, cnv;\n\n  const [rectCoordinates, setRectCoordinates] = React.useState([\n    { x: 0, y: 0 },\n    { x: 0, y: 0 },\n    { x: 0, y: 0 },\n    { x: 0, y: 0 },\n  ]);\n\n  const setup = (p5, canvasParentRef) => {\n    let DrawRectClass = new DrawRect(p5);\n    cnv = p5.createCanvas(canvasWidth, canvasHeight).parent(canvasParentRef);\n    input = p5.createFileInput((file) => handleFile(file, p5));\n    insertPhotoView(input.elt);\n\n    cnv.mousePressed((event) => {\n      console.log(\"mousePressed\");\n      DrawRectClass.update({ x1: p5.mouseX, y1: p5.mouseY });\n    });\n    cnv.mouseClicked((event) => {\n      console.log(\"mouseClicked\");\n      DrawRectClass.display();\n      let { x1, y1, x2, y2 } = DrawRectClass.coordinate;\n\n      setRectCoordinates((prev) =>\n        prev.map((v, i) => {\n          // 左上\n          if (i === 0) {\n            v = { x: x1, y: y1 };\n          }\n          // 右上\n          if (i === 1) {\n            v = { x: x2, y: y1 };\n          }\n          // 左下\n          if (i === 2) {\n            v = { x: x1, y: y2 };\n          }\n          // 右下\n          if (i === 3) {\n            v = { x: x2, y: y2 };\n          }\n          return v;\n        })\n      );\n    });\n  };\n\n  const draw = (p5) => {\n    let DrawRectClass = new DrawRect(p5);\n    if (img) {\n      let width = (img.width * canvasHeight) / img.height;\n      let x = (canvasWidth - width) / 2;\n      p5.image(img, x, 0, width, canvasHeight);\n    }\n    if (p5.mouseIsPressed) {\n      // console.log(\"mouseIsPressed\");\n      DrawRectClass.update({ x2: p5.mouseX, y2: p5.mouseY });\n    }\n  };\n\n  function handleFile(file, p5) {\n    if (file.type === \"image\") {\n      img = p5.createImg(file.data);\n      img.hide();\n    }\n  }\n\n  function handleExportJSON() {\n    alert(JSON.stringify({ rectCoordinates }));\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"layoutBox\">\n        <div className=\"left\">\n          <div className=\"photo-wrap\">\n            <h1 className=\"mb-20 text-align-center\">標記系統</h1>\n            <div className=\"photo-view\">\n              <Sketch setup={setup} draw={draw} />\n            </div>\n          </div>\n        </div>\n        <div className=\"right\">\n          <pre>\n            <code style={{ color: \"#fff\" }}>\n              {`(${rectCoordinates[0].x}, ${rectCoordinates[0].y})`},\n              {`(${rectCoordinates[1].x}, ${rectCoordinates[1].y})`}\n              <br />\n              {`(${rectCoordinates[2].x}, ${rectCoordinates[2].y})`},\n              {`(${rectCoordinates[3].x}, ${rectCoordinates[3].y})`}\n            </code>\n          </pre>\n\n          <button onClick={handleExportJSON}>輸出 JSON</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}